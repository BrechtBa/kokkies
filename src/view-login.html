<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/iron-icon/iron-icon.html">


<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-material/paper-material.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">

<dom-module id="view-login">

    <template>

        <style include="shared-styles"></style>
        <style>
            :host {
                display: block;
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: var(--app-primary-color);

                @apply(--layout);
                @apply(--layout-center-center);
            }
            paper-material{
                padding: 10px;
            }
            .buttons{
                margin-top: 10px;
                text-align: center;
            }
            .coloredbackground paper-button > * {
                vertical-align: middle;
                text-transform: none;
                color: #ffffff;
            }
            .coloredbackground paper-input-container{
                 --paper-input-container-color: #dddddd;
                 --paper-input-container-input-color: #ffffff;
            }
            .info {
                margin-top: 40px;
                text-align: center;
                color: #ffffff;
            }
            .info a{
                color: #1f0d9e;
            }

        </style>

        <paper-material class="coloredbackground">
            <paper-input label="email" value="{{email}}"></paper-input>
            <paper-input label="password" value="{{password}}" type="password"></paper-input>

            <div class="buttons">
                <paper-button raised on-tap="signIn" disabled="[[disabled]]">
                    <iron-icon icon="account-circle"></iron-icon>
                    <span>Sign in</span>
                </paper-button>
            </div>

            <div class="info">
                <div>No account: <a href="#" on-tap='registerDialog'> register</a></div>
                <!--<div>Forgot your password? Click<a href="#" on-tap='resetPasswordDialog'> here</a></div>-->
            </div>
        </paper-material>



        <paper-dialog id="registerDialog">
            <paper-button class="close" dialog-dismiss>close</paper-button>

            <paper-input label="email" value="{{newEmail}}"></paper-input>
            <paper-input label="password" value="{{newPassword}}" type="password"></paper-input>
            <paper-input label="repeat password" value="{{repeatPassword}}" type="password"></paper-input>

            <div class="buttons">
                <paper-button raised on-tap="register" disabled="[[disabled]]">
                    Register
                </paper-button>
            </div>

        </paper-dialog>



        <paper-dialog id="resetPassword">
            <paper-button class="close" dialog-dismiss>close</paper-button>

            <paper-input label="email" value="{{resetEmail}}"></paper-input>

            <div class="buttons">
                <paper-button raised on-tap="resetPassword" disabled="[[disabled]]">
                    Send new password
                </paper-button>
            </div>

        </paper-dialog>

    </template>

    <script>

        Polymer({

            is: 'view-login',

            properties:{
                disabled: {
                    type: Boolean,
                    reflectToAttribute: true,
                    value: false
                },
                signedIn: {
                    type: Boolean,
                    reflectToAttribute: true,
                    value: false
                }
            },
            signIn: function() {
                this.fire('sign-in', {'email':this.email,'password':this.password}, { bubbles: false });
                this.password= '';
            },

            registerDialog: function(){
                this.$.registerDialog.open();
            },

            register: function(){
                if(this.password==this.repeatPassword){
                    this.fire('register', {'email':this.newEmail,'password':this.newPassword}, { bubbles: false });
                }
            },

            resetPasswordDialog: function(){
                this.$.resetPassword.open();
            },

            resetPassword: function(){
                this.fire('reset-password', {'email':this.resetEmail}, { bubbles: false });
                this.$.resetPassword.close();
            },
        });

    </script>

</dom-module>
